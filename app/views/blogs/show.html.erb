<%= render 'layouts/search' %>
<div class="page-header"><h1><%= link_to @blog.name, "http://#{@blog.name}", target: "_blank" %></h1></div>

<% if @blog.posts.present? %>
		<table class="table">
		<caption>TOP 30</caption>
			<tr>
				<th class="col-xs-1">Rank</th>
				<th class="col-xs-1">Notes</th>
				<th class="col-xs-8">Post</th>
				<th class="col-xs-1">Type</th>
				<th class="col-xs-1">Date</th>
			</tr>
			<% @blog.posts.each_with_index do |post, index|%>
				<tr>
					<td><%= index + 1 %></td>
					<td><%= post["note_count"] %></td>
					  <td class="center">
					  
					  
					  		<% if post["type"] == "photo" %>
					  			<%= content_tag :a, href: post["short_url"], target: "_blank" do %>
					  				<%= content_tag :img, nil, src: post["photos"][0]["alt_sizes"][2]["url"] %>
					  			<% end %>
					  		<% elsif post["type"] =="text" %>

						  		<%= content_tag :p do %>
						  			<% if post["title"].present? %>
						  				<%= content_tag :a, href: post["short_url"], target: "_blank" do %>
						  					<%= post["title"] %>
					  					<% end %>
					  				<% else %>
						  				<%= post["body"].html_safe %>
						  				<%= content_tag :a, "link to text post", href: post["short_url"], target: "_blank" %>
					  				<% end %>
					  			<% end %>
					  		<% elsif post["type"] == "video" %>
					  			<% if post["thumbnail_url"].present? %>
					  				<%= content_tag :a, href: post["short_url"], target: "_blank" do %>
					  					<%= content_tag :img, nil, src: post["thumbnail_url"] %>
				  					<% end %>
				  				<% else %>
					  				<%= post["caption"].html_safe %>
					  				<%= content_tag :a, "link to video post", href: post["short_url"], target: "_blank" %>
				  				<% end %>
					  		<% elsif post["type"] == "audio" %>
					  			<% if post["thumbnail_url"].present? %>
					  				<%= content_tag :a, href: post["short_url"], target: "_blank" do %>
					  					<%= content_tag :img, nil, src: post["album_art"] %>
					  				<% end %>
				  				<% else %>
					  				<%= post["caption"].html_safe %>
					  				<%= content_tag :a, "link to audio post", href: post["short_url"], target: "_blank" %>
				  				<% end %>
				  			<% elsif post["type"] == "quote" %>
				  				<%= content_tag :a, href: post["short_url"], target: "_blank" do %>
				  				 	<%= content_tag :p, post["text"] %>
				  				 <% end %>
				  			 <% elsif post["type"] == "link" %>
				  			 	<%= content_tag :a, href: post["short_url"], target: "_blank" do %>
				  			 		<%= content_tag :p, post["title"] %>
				  			 	<% end %>
				  			 <% elsif post["type"] == "chat" %>
					  			 	<% if post["title"].present? %>
							  				<%= content_tag :h5, post["title"] %>
				  					<% end %>
				  					<%= content_tag :p, post["body"].html_safe %>
				  					<%= content_tag :a, "link to chat post", href: post["short_url"], target: "_blank" %>
				  			 <% elsif post["type"] == "answer" %>
				  			 	<%= content_tag :h5, post["question"] %>
				  			 	<%= content_tag :p, post["answer"].html_safe %>
				  			 	<%= content_tag :a, "link to answer post", href: post["short_url"], target: "_blank" %>
					  		<% end %>
						
					  </td>
					  <td><%= post["type"] %></td>
					 <td><%= Time.at(post["timestamp"]).strftime('%m/%d/%Y') %></td>
				</tr>
			<% end %>
		</table>
	<% end %>